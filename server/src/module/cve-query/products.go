package cve_query

import (
	"enigma/server/src/common/defs"
	cve_search "enigma/server/src/engine/cve-search"
	"github.com/labstack/echo/v4"
	"net/http"
)

func getProductsHandler(c echo.Context) error {
	vendorStr := c.QueryParam("vendor")
	if len(vendorStr) == 0 {
		return c.JSON(http.StatusOK, defs.HttpResponse{
			Code:    1,
			Msg:     "vendor should be provided for this endpoint",
			Payload: nil,
		})
	}
	productlist, err := cve_search.GetProductlist(G, vendorStr)
	if err == nil {
		return c.JSON(http.StatusOK, defs.SuccessResponse(productlist))
	} else {
		return c.JSON(http.StatusOK, defs.HttpResponse{
			Code:    1,
			Msg:     "failed to get product list for vendor",
			Payload: nil,
		})
	}
}