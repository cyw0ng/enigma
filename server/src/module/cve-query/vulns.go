package cve_query

import (
	"enigma/server/src/common/defs"
	cve_search "enigma/server/src/engine/cve-search"
	"github.com/labstack/echo/v4"
	"net/http"
)

func getCVEHandlerV1(c echo.Context) error {
	cveId := c.QueryParam("id")
	if len(cveId) == 0 {
		return c.JSON(http.StatusOK, defs.HttpResponse{
			Code:    1,
			Msg:     "cveId should be provided for this endpoint",
			Payload: nil,
		})
	}
	cveRecord, err := cve_search.GetCVERecordFromID(G, cveId)
	if err == nil {
		return c.JSON(http.StatusOK, defs.SuccessResponse(cveRecord))
	} else {
		return c.JSON(http.StatusOK, defs.HttpResponse{
			Code:    1,
			Msg:     "failed to get cve record",
			Payload: nil,
		})
	}
}