package cve_search

import (
	"encoding/json"
	"enigma/server/src/common/cmds"
	"enigma/server/src/common/defs"
)

func GetVendorlist() (*defs.CVEBrowse, error){
	response := cmds.CurlHttpsRequest(defs.GetVendorlistHTTPS)

	vendorlist := &defs.CVEBrowse{}

	err := json.Unmarshal([]byte(response), &vendorlist)

	if err != nil {
		return nil, err
	}

	return vendorlist, nil
}