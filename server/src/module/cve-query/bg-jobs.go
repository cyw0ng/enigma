package cve_query

import (
	"enigma/server/src/common/defs"
	capec_analyze "enigma/server/src/engine/capecBackend"
	cve_search "enigma/server/src/engine/cveBackend"
)

func startModuleBgJobs(G *defs.Global) {
	G.Log.Info("capec_anayze: start analyzing from background")
	count, err := cve_search.GetCapecCountInDB(G)
	if err != nil || count == 0 {
		err := capec_analyze.InitCapecAnalyze(G)
		if err != nil {
			G.Log.Info("capec_anayze: capec analyzing failed")
		} else {
			G.Log.Info("capec_anayze: start analyzing from background")
		}
	} else {
		G.Log.Info("capec_anayze: capec has been analyzed, skip")
	}
}
